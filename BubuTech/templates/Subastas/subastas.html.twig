{% extends 'base.html.twig' %}
    {% block stylesheets %}
        {{ parent() }}    
        <link rel="stylesheet" href="{{ asset('css/subastas.css') }}">
    {% endblock %}
    {% block body %}   
        <main>
            <div class="busqueda-wrapper">
                <form method="get" action="{{ path('listar_subastas') }}" class="busqueda-header" style="float: right;">
                    <input type="text" name="q" placeholder="Buscar subastas..." value="{{ app.request.get('q') }}">
                    <button type="submit">üîç</button>
                </form>
                {% for message in app.flashes('publicada') %}
                    <div class="flash-success">{{ message }}</div>
                {% endfor %}
            </div>
            
            <h2 class="title">Lista de Subastas</h2>

            <div class="subastas">
                {% for subasta in subastas %}
                    <div class="subasta-card">
                        <div class="subasta-imagen">
                            {% if subasta.producto.imagen %}
                                <img src="{{ asset('uploads/productos/' ~ subasta.producto.imagen) }}" alt="{{ subasta.producto.nombre }}">
                            {% else %}
                                <img src="{{ asset('images/placeholder.png') }}" alt="Sin imagen">
                            {% endif %}
                        </div>
                        <div class="subasta-info">
                            <h3>{{ subasta.producto.nombre }}</h3>
                            <p class="descripcion">{{ subasta.producto.descripcion }}</p>
                            <p><strong>Precio base:</strong> ${{ subasta.precioBase }}</p>
                            <p><strong>Categor√≠a:</strong> {{ subasta.categoria ?? 'Sin categor√≠a' }}</p>
                            <p><strong>Estado:</strong> {{ subasta.estado.value }}</p>
                            {% if subasta.estado.value == 'activa' %}
                                <p><strong>Finaliza:</strong> {{ subasta.duracion|date('d/m/Y H:i') }}</p>
                            {% endif %}
                            <a href="{{ path('detalle_subasta', {id: subasta.id}) }}" class="btn-detalle">Ver detalle</a>
                        </div>
                    </div>
                {% else %}
                    <p>No hay subastas publicadas por el momento.</p>
                {% endfor %}
            </div>
        </main>
    {% endblock %}